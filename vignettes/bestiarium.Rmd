---
title: "The xpose plots"
author: "Benjamin Guiastrennec"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Customize plots}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include=FALSE}
library(xpose)

knitr::opts_chunk$set(fig.dpi = 96,
                      fig.align = 'center', 
                      fig.height = 6, 
                      fig.width = 6,
                      out.width = '75%',
                      comment = '',
                      message = FALSE)
                      
```

## Create example xpdb
```{r}
xpdb <- xpdb_ex_pk %>% 
filter(OCC == 3, .problem = 1) # Only look at occasion 3
```


## Basic goodness-of-fit plots
### Plots of the independent variable (IDV)
```{r}
dv_vs_idv(xpdb)
ipred_vs_idv(xpdb)
pred_vs_idv(xpdb)
dv_preds_vs_idv(xpdb)
```

### DV vs. PREDs plots
```{r}
dv_vs_pred(xpdb)
dv_vs_ipred(xpdb)
```

### Residual plots
```{r}
res_vs_idv(xpdb, res = 'CWRES')
res_vs_pred(xpdb, res = 'CWRES')
absval_res_vs_idv(xpdb, res = 'CWRES')
absval_res_vs_pred(xpdb, res = 'CWRES')
```

## Minimization plots
```{r}
prm_vs_iteration(xpdb)
grd_vs_iteration(xpdb)
```

## Individual plots
```{r}
ind_plots(xpdb, page = 1)
```

## Distributions
### Histograms and density plots
```{r}
prm_distrib(xpdb)
eta_distrib(xpdb)
res_distrib(xpdb)
cov_distrib(xpdb)
```

### QQ plots
```{r}
prm_qq(xpdb)
eta_qq(xpdb)
res_qq(xpdb)
cov_qq(xpdb)
```

## Kinetic plots
### Compartment's amount
```{r}
amt_vs_idv(xpdb)
```

## Visual predictive checks (VPC)
### Continuous vpc
```{r}
xpdb_ex_pk %>% 
 vpc_data() %>% 
 vpc()
```

### Censored vpc
```{r}
xpdb_ex_pk %>% 
 vpc_data(vpc_type = 'censored', opt = vpc_opt(lloq = 1)) %>% 
 vpc()
```


### Categorical vpc
```{r, eval=FALSE}
xpdb_ex_pk %>% 
 vpc_data(vpc_type = 'categorical') %>% 
 vpc()
```


